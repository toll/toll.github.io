<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Maskinporten</title>
    <meta name="description" content="Norwegian Customs' integration with Maskinporten">
    <meta name="author" content="Tolletaten">
    <link rel="stylesheet" href="../../style/api.css">
    <link rel="icon" href="../../media/toll-logo/favicon.ico"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="theme-color" content="#000000"/>
    <link rel="shortcut icon" href="../../media/toll-logo/logo32.png" type="image/png"/>
    <link rel="apple-touch-icon" href="../../media/toll-logo/logo152.png"/>
    <link rel="apple-touch-icon-precomposed" href="../../media/toll-logo/logo152.png"/>
    <meta name="msapplication-TileColor" content="#FFFFFF"/>
    <meta name="msapplication-TileImage" content="/logo152.png"/>
</head>
<body>


<header>
    <a href="../../index-EN.html">
        <img src="../../media/toll-logo/logo-toll.svg" alt="Tolletaten" class="logo"/>
    </a>

    <a href="../maskinporten/maskinporten.html" class="nav-language-button" role="navigation">
        <div class="lang_nav">
            <span>NO</span>
            <img class="flag-rounded" src="../../media/flag/NO-flag.svg" alt="Norwegian flag">
        </div>
    </a>
</header>

<main class="maskinporten">
    <div class="about-section align-self-start" role="main">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../../index-EN.html">Home</a></li>
                <li class="breadcrumb-item active" aria-current="page">Maskinporten</li>
            </ol>
        </nav>

        <h1 id="hva-er-maskinporten">What is Maskinporten?</h1>
        <div>
            <img class="img-right"
                 src="../media/digdir-logo.png" alt="digdir-logo">
            <p>
                <strong>Maskinporten and Altinn</strong>
                are national common components developed
                and operated by the Norwegian Digitalisation
                <strong>Agency (Digitaliseringsdirektoratet - Digdir).</strong>
            </p>

            <p>
                Together, they aim to simplify the sharing and use of data across systems, for example by granting
                organizations appropriate access to data offered by public entities via interfaces.
                The solution guarantees identity between organizations and ensures authentication in
                machine-to-machine communication. It enables systems to be connected and new services
                to be developed efficiently.
            </p>

            <p>
                To use <strong>Maskinporten</strong>, the organization must either be registered in the Norwegian Entity
                Registry with a <strong>Norwegian organization number</strong>or possess an enterprise certificate
                listed on the <strong>EU’s “List of Trusted Lists.”</strong>
            </p>
        </div>

        <h1 id="drift">Operations and monitoring</h1>
        <p>
            Maskinporten aims to maintain an uptime of 99.9% and, in
            case of any deviations, it rarely experiences downtime
            exceeding 5 minutes. Therefore, we recommend that our
            clients implement a retry mechanism to <em>try
            again</em> if messages are rejected without clear error
            messages.
        </p>
        <p>We further recommend monitoring both planned and
            unplanned operational disruptions:</p>
        <ul>
            <li><a href="https://status.digdir.no/history?filter=nthvr1xysxs7"
                   target="_blank">Digdir Status - History</a>
                at <a target="_blank" href="https://status.digdir.no/">https://status.digdir.no/</a></li>
        </ul>
        <p> It is also possible to verify if Maskinporten is up by using the links below:</p>
        <ul>
            <li><p><a href="https://oidc.difi.no/idporten-oidc-provider/health"
                      class="uri" target="_blank">https://oidc.difi.no/idporten-oidc-provider/health</a></p></li>
            <li><p><a href="https://maskinporten.no/health"
                      class="uri" target="_blank">https://maskinporten.no/health</a></p></li>
        </ul>
        <a href="https://docs.digdir.no/docs/Maskinporten/maskinporten_feilsoking" target="_blank">
            Maskinporten has also created a troubleshooting page
        </a>

        <h1 id="hva-skal-til-for-a-bruke-maskinporten">What is needed to use Maskinporten?</h1>

        <p>
            The process differs for Norwegian and European organizations. The procedure for European organizations can
            <a href="#europeisk">be found here</a>.
        </p>

        <h2 id="norsk">For Norwegian organizations</h2>
        <p>Guide aligned with Maskinporten’s official documentation</p>

        <a href="https://docs.digdir.no/docs/Maskinporten/maskinporten_guide_apikonsument" target="_blank">
            The guide below is in line with Maskinporten's own documentation
        </a>

        <br/>
        <br/>

        <a href="https://samarbeid.digdir.no/maskinporten/konsument/119" target="_blank">
            See also Digdir's guide on how to get started with Maskinporten:
        </a>

        <p id="orgnummer"><strong>Prerequisite</strong>: the
        organization has a Norwegian organization number</h3>

        <h3 id="anskaffe-virksomhetssertifikat">1. Acquire a company certificate for testing and production
            purpose</h3>
        <p>
            Digdir will validate your signature against your
            organization's certificate issued by a recognized
            certificate provider. Find more documentation on this
            process <a href="https://docs.digdir.no/docs/Maskinporten/maskinporten_virksomhetssertifikat"
                       target="_blank">at Digdir</a>.
        </p>
        <p>
            Here are some options for acquiring an organization
            certificate:
        </p>
        <ul>
            <li><p><a
                    href="https://www.commfides.com/commfides-virksomhetssertifikat/" target="_blank">
                https://www.commfides.com/commfides-virksomhetssertifikat/</a>
            </p></li>
            <li><p><a
                    href="https://www.buypass.no/produkter/virksomhetssertifikat-esegl" target="_blank">
                https://www.buypass.no/produkter/
                virksomhetssertifikat-esegl</a>
            </p></li>
        </ul>

        <h3 id="bli-kunde-hos-digdir">2. Become a customer of Digdir for access to the collaboration portal</h3>
        <p>Contact Digdir via <a href="mailto:servicedesk@digdir.no">servicedesk@digdir.no</a></p>

        <h3 id="bli-api-kunde">3. Register for access with Norwegian Customs</h3>
        <p>
            The registration form can be found here:
            <a target="_blank"
               href="https://www.toll.no/en/corporate/digitoll/this-is-digitoll/registration-for-businesses---digitoll">
                Registration: Digitoll-actor - Norwegian Customs
            </a>
        </p>

        <p>Norwegian Customs provides access to the scopes needed for
        the relevant integration, see
            <a href="#scopes">overview below</a>.</p>

        <h3 id="lag-en-integrasjon">4. Create an integration with Digdir and connect it to Norwegian Customs' API (scope)</h3>
        <p>
          For <strong>PROD</strong>: Log in to
          <a href="https://sjolvbetjening.samarbeid.digdir.no"
             target="_blank">Self-service portal (digdir.no)</a>
        </p>
        <p>
          For <strong>TEST</strong>: Log in to
          <a href="https://sjolvbetjening.test.samarbeid.digdir.no"
             target="_blank">Self-service portal (digdir.no)</a>
        </p>

        <ul class="spaced-list">
            <li>Difi-service = Maskinporten</li>
            <li>Add scopes &ndash; see <a href="#scopes">overview of our scopes below</a></li>
            <li>
                <em>Integration identifier:</em> This is what should be set in the
                "iss" field of your JWT sent to Difi (cf.
                <a href="#hent-maskinporten-token">section below</a>).
            </li>
            <li>
                <em>Name of the integration:</em> You are free to
                choose what the integration with Norwegian Customs
                should be called.<br/> It may be beneficial to give
                a name that distinguishes between different services
                and APIs for Norwegian Customs, as we have several
                different APIs.
            </li>
            <li>
                <em>Grant-types:</em> We currently
                use <code>urn:ietf:params:oauth:grant-type:jwt-bearer</code>,
                this may change in the future.
            </li>
        </ul>

        <br/>

        <section class="image-border">
            <div>
                <h4 id="integrasjon-selvbetjening">4.1 Go to self-service for integrations</h4>
                <figure>
                    <img class="image-size" src="../media/maskinporten/maskp-login.png"
                         alt="Figure: Go to self-service"/>
                    <figcaption>Figure: Login at self-service</figcaption>
                </figure>

                <figure>
                    <img src="../media/maskinporten/maskp-virksomhet.png" alt="Select your organization"/>
                    <figcaption>Figure: Select your organization</figcaption>

                </figure>

                <figure>
                    <img class="image-size" src="../media/maskinporten/maskp-klient.png" alt="Select client"/>
                    <figcaption>Figure: For those integrating a service, select Client</figcaption>
                </figure>

                <h4 id="ny-integrasjon">4.2 New integration</h4>
                <figure>
                    <img class="image-size" src="../media/maskinporten/maskp-klienter-legg-til-ny.png"
                         alt="Add new integration."/>
                    <figcaption>
                        Figure: Here is a list of your clients. For a
                        new client integration, click Add new.
                    </figcaption>
                </figure>

                <figure>
                    <img class="image-size" src="../media/maskinporten/maskp-maskinporten.png"
                         alt="Select Maskinporten"/>
                    <figcaption>Figure: Select Maskinporten.</figcaption>
                </figure>

                <figure>
                    <img class="image-size"
                         src="../media/maskinporten/maskp-legg-til-scope.png"
                         alt="Select Add scope"/>
                    <figcaption>
                        Figure: After entering your chosen name and
                        description, click Add scope
                    </figcaption>
                </figure>

                <figure>
                    <img class="image-size"
                         src="../media/maskinporten/maskp-scopes.png"
                         alt="Select the scopes you need"/>
                    <figcaption>
                        Figure: Select the scopes you need, you
                        can find an <a href="#scopes">overview below</a>
                    </figcaption>
                </figure>

                <figure>
                    <img class="image-size"
                         src="../media/maskinporten/maskp-integrasjon.png"
                         alt="Overview of the integration"/>
                    <figcaption>
                        Figure: After clicking create, you will get
                        an overview of your integrations/clients.
                        Click the one you just created to see
                        details and edit if needed.
                    </figcaption>
                </figure>
            </div>
        </section>

        <div class="about-section-text">
            <h3 id="klientintegrasjon">5. Client Integration</h3>
            <p>
                API consumers must develop an application/system that
                retrieves access tokens from Maskinporten and exchanges
                them for Toll-signed access tokens.
            </p>
            <p class="tips_box_normal">
                <strong>TIPS:</strong><br/> A Toll-signed access token
                can be used for its entire lifetime, so it is
                recommended to cache these when communicating with
                Norwegian Customs' APIs. For a smoother experience, it
                is further recommended to exchange for a new Toll token
                before (e.g., 1 minute before) the lifetime of the
                previous one expires.
            </p>

            <br/>

            <h3 id="scopes">Our scopes</h3>
            <p>The scope(s) you should use depend on the services you will use and require assigned access to this
                scope from Norwegian Customs:</p>
            <ul class="spaced-list">
                <li>movement-road-api: <strong>toll:movement/road</strong></li>
                <li>movement-road-api-v2, movement-road-query-api-v2: <strong>toll:movement/road/v2</strong></li>
                <li>movement-air-api, movement-air-query-api: <strong>toll:movement/air</strong></li>
                <li>movement/presentation, movement/routing: <strong>toll:movement/entry</strong></li>
                <li>Document upload: <strong>toll:goodsdeclaration/document.write</strong></li>
            </ul>

            <br/>

            <h4 id="hent-maskinporten-token">5.1 Retrieve access token from Maskinporten</h4>
            <p>See Maskinporten's own <a
                    href="https://docs.digdir.no/docs/Maskinporten/maskinporten_guide_apikonsument" target="_blank">documentation</a>
                on how to retrieve an access token.</p>
            <p class="tips_box_normal">
                <strong>TIPS:</strong><br/>
                Difi has published a <a href="https://github.com/difi/jwt-grant-generator" target="_blank">repository
                on GitHub (jwt-grant-generator)</a> that demonstrates how to retrieve access tokens from Difi's
                services, including Maskinporten.
            </p>

            <br/>

            <h4 id="veksle-token">5.2 Exchange Maskinporten's access token for a Toll-signed access token</h4>

            <h5 id="http-request">HTTP Request</h5>
            <p>Method: <strong>POST</strong></p>
            <p>URL:</p>
            <table>
                <thead>
                <tr>
                    <th scope="col">Environment</th>
                    <th scope="col">URL</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Test</td>
                    <td><a target="_blank" href="https://api-test.toll.no/api/access/external/oauth/token">https://api-test.toll.no/api/access/external/oauth/token</a>
                    </td>
                </tr>
                <tr>
                    <td>Production</td>
                    <td><a target="_blank" href="https://api.toll.no/api/access/external/oauth/token">https://api.toll.no/api/access/external/oauth/token</a>
                    </td>
                </tr>
                </tbody>
            </table>

            <p>HEADER:</p>
            <table>
                <thead>
                <tr>
                    <th scope="col">Header</th>
                    <th scope="col">Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Content-type</td>
                    <td>application/x-www-form-urlencoded</td>
                </tr>
                </tbody>
            </table>

            <p>BODY:</p>
            <table>
                <thead>
                <tr>
                    <th scope="col">Key</th>
                    <th scope="col">Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>grant_type</td>
                    <td>token-exchange</td>
                </tr>
                <tr>
                    <td>subject_token_type</td>
                    <td>access_token</td>
                </tr>
                <tr>
                    <td>subject_token</td>
                    <td>&lt;MASKINPORTEN ACCESS TOKEN HERE&gt;</td>
                </tr>
                </tbody>
            </table>

            <h5 id="eksempel-http-response">Example: HTTP Response</h5>
            <p><strong>Maskinporten Access Token - Response</strong></p>

            <pre class="boxed-display">
{
  "issued_token_type": "access_token",
  "access_token": "&lt;TOLL ACCESS TOKEN HERE&gt;",
  "token_type": "Bearer",
  "expires_in": 970
}

</pre>

            <h4 id="teste-tilgang-til-api">5.3 Test access to the API</h4>
            <p>This example applies to the road vehicle API.</p>

            <h5 id="http-request-1">HTTP Request</h5>
            <p>Method: <strong>GET</strong></p>
            <p>URL:</p>
            <table>
                <thead>
                <tr>
                    <th scope="col">Environment</th>
                    <th scope="col">URL</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Test</td>
                    <td><a target="_blank" href="https://api-test.toll.no/api/movement/road/v1/test-auth">
                        https://api-test.toll.no/api/movement/road/v1/test-auth
                    </a>
                    </td>
                </tr>
                <tr>
                    <td>Production</td>
                    <td><a target="_blank" href="https://api.toll.no/api/movement/road/v1/test-auth">
                        https://api.toll.no/api/movement/road/v1/test-auth
                    </a>
                    </td>
                </tr>
                </tbody>
            </table>

            <p>HEADER:</p>
            <table>
                <thead>
                <tr>
                    <th scope="col">Header</th>
                    <th scope="col">Value</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                    <td>Authorization</td>
                    <td>Bearer &lt;TOLL ACCESS TOKEN&gt;</td>
                </tr>
                </tbody>
            </table>
            <p>Expected result is <strong>200 OK</strong>.</p>

            <h2 id="europeisk">For European organizations</h2>
            <p><strong>Requirement</strong>: The enterprise has an enterprise certificate listed on the EU’s “List of Trusted Lists.</p>

            <p><a target="_blank" href="https://docs.digdir.no/docs/Maskinporten/maskinporten_func_european_eseals.html">
                European eSeals | Maskinporten
            </a>,
            follow the guide for European organizations.</p>

            <h3>1. Obtain a valid European enterprise certificate</h3>
            <p>
                The client must have a valid electronic seal certificate issued by a qualified trust service provider
                listed on the
                <a target="_blank"
                   href="https://eidas.ec.europa.eu/efda/trust-services/browse/eidas/tls/search/type?step=3&searchCriteria=eyJzZXJ2aWNlU2NvcGUiOiJBTEwiLCJjb3VudHJ5Q29kZXMiOlsiQVQiLCJCRSIsIkJHIiwiSFIiLCJDWSIsIkNaIiwiREsiLCJFRSIsIkZJIiwiRlIiLCJERSIsIkVMIiwiSFUiLCJJUyIsIklFIiwiSVQiLCJMViIsIkxJIiwiTFQiLCJMVSIsIk1UIiwiTkwiLCJOTyIsIlBMIiwiUFQiLCJSTyIsIlNLIiwiU0kiLCJFUyIsIlNFIiwiVUsiXSwic2VydmljZUxlZ2FsVHlwZXMiOlsiUV9DRVJUX0VTRUFMIiwiQ0VSVF9FU0VBTCJdfQ%3D%3D">
                    EU Trusted List</a>.
                Note that a listed provider typically offers multiple certificate
                services, which usually originate from different
                chains/roots, and just some of these chains/roots
                are in the trusted list.
            </p>


            <h3>2. Register for access with the Norwegian Customs (Tolletaten)</h3>
            <p>
                Registration form:
                <a href="https://www.toll.no/en/corporate/digitoll/this-is-digitoll/registration-for-businesses---digitoll"
                   target="_blank">
                    Digitoll Registration – Tolletaten
                </a>
            </p>

            <p>
                Tolletaten grants access to the scope(s) required for
                the relevant integration. <a href="#scopes-eu">See the
                scopes below</a>.
            </p>

            <h3>3. Client Integration</h3>
            <p>
                API consumers must develop an application/system that
                retrieves access tokens from Maskinporten and exchanges
                them for Toll-signed access tokens.
            </p>
            <p class="tips_box_normal">
                <strong>TIPS:</strong><br/> A Toll-signed access token
                can be used for its entire lifetime, so it is
                recommended to cache these when communicating with
                Norwegian Customs' APIs. For a smoother experience, it
                is further recommended to exchange for a new Toll token
                before (e.g., 1 minute before) the lifetime of the
                previous one expires.
            </p>

            <h3 id="scopes-eu">Our scopes</h3>
            <p>The scope(s) you should use depend on the services you will use and require assigned access to this
                scope from Norwegian Customs:</p>
            <ul class="spaced-list">
                <li>movement-road-api: <strong>toll:eu/movement/road</strong></li>
                <li>movement-road-api-v2, movement-road-query-api-v2: <strong>toll:eu/movement/road/v2</strong></li>
                <li>movement-air-api, movement-air-query-api: <strong>toll:eu/movement/air</strong></li>
                <li>movement/presentation, movement/routing: <strong>toll:eu/movement/entry</strong></li>
                <li>Document upload: <strong>toll:eu/goodsdeclaration/document.write</strong></li>
            </ul>

            <h4>3.1 Retrieve access token from Maskinporten</h4>
            <p>See Digdir’s documentation under request
                <a href="https://docs.digdir.no/docs/Maskinporten/maskinporten_func_european_eseals.html"
                   target="_blank">European eSeals | Maskinporten
                </a>
            </p>

            <h4>3.2 Retrieve access token from Maskinporten</h4>
            <p><a href="#veksle-token">
                Same procedure as for Norwegian organizations
            </a>.</p>

            <h4>3.3 Retrieve access token from Maskinporten</h4>
            <p><a href="#teste-tilgang-til-api">
                Same procedure as for Norwegian organizations
            </a>.</p>

        </div>
    </div>
</main>

<footer role="contentinfo">
    <a target="_blank" href="https://www.toll.no/en/">Norwegian Customs</a> 2025 | <a
        href="https://www.toll.no/en/about-norwegian-customs/contact-us/" class="white">Contact us</a>
</footer>

</body>
</html>
