<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <title>Beskrivelse av koblings-API i MO</title>
    <meta name="description" content="Beskrivelse av koblings-API i MO">
    <meta name="author" content="Tolletaten">
    <link rel="stylesheet" href="../../style/api.css">
    <link rel="icon" href="../../media/toll-logo/favicon.ico"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="theme-color" content="#000000"/>
    <link rel="shortcut icon" href="../../media/toll-logo/logo32.png" type="image/png"/>
    <link rel="apple-touch-icon" href="../../media/toll-logo/logo152.png"/>
    <link rel="apple-touch-icon-precomposed" href="../../media/toll-logo/logo152.png"/>
    <meta name="msapplication-TileColor" content="#FFFFFF"/>
    <meta name="msapplication-TileImage" content="../../media/toll-logo/logo152.png"/>
</head>
<body>

<header>
    <a href="../../index.html">
        <img src="../../media/toll-logo/logo-toll.svg" alt="Tolletaten" class="logo"/>
    </a>

    <a href="beskrivelse-av-koblings-api-EN.html" class="nav-language-button" role="navigation">
        <div class="lang_nav">
            <span>EN</span>
            <img class="flag-rounded" src="../../media/flag/ENG-flag.svg" alt="Norsk flagg">
        </div>
    </a>
</header>

<main class="funksjonell-beskrivelse">
    <div class="align-self-start" role="main">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="../../index.html">Hjem</a></li>
                <li class="breadcrumb-item"><a href="melde-og-opplysning.html">Melde og opplysning</a></li>
                <li class="breadcrumb-item active" aria-current="page">Beskrivelse av koblings-API</li>
            </ol>
        </nav>

        <h1 id="funkbesk">Løsningen for melde- og opplysning har API for å koble meldinger sammen</h1>

        <h2>Bakgrunn:</h2>

        <p>Dagens løsning krever:</p>
        <ul class="spaced-list">
            <li>At innsender av transportmelding har ansvar for å sende hvilke hovedfraktbrev og fraktbrev
                (direkteforsendelse) som er med i transporten.
            </li>
            <li>At innsender av forsendelse har ansvar for å sende inn referanse til overliggende hovedfraktbrevnummer
                (eller overliggende transport ved direkteforsendelser) samt referanse til deklarasjonen i TVINN.
            </li>
        </ul>

        <p>
            Næringslivsaktørene har etterlyst en større fleksibilitet for hvilke innsendere som kan
            <strong>"ta ansvar"</strong> for at nødvendig koblingsinformasjon er på plass i meldingene innsendt i MO.
        </p>

        <p>
            Tolletaten har derfor lagt til rette for at aktørene kan avtale seg imellom hvem som er best egnet til å
            sende inn nødvendig koblingsinformasjon ved å skille ut koblingene i egne koblingsmeldinger
            <strong>(kalt relation i API)</strong>.
        </p>

        <p>
            Koblingsmeldingene er <strong>et tillegg til dagens løsning</strong> med innsendelse av referanser i de
            respektive meldinger.
        </p>

        <h2>Koblings-API:</h2>

        <p>Koblingsmeldinger følger standard mønster:</p>
        <ul class="spaced-list">
            <li>Opprette <strong>(POST)</strong> - Virksomhet oppretter request-id, Tolletaten oppretter og returnerer
                MRN
            </li>
            <li>Slette <strong>(DELETE)</strong> - Virksomhet sender inn request-id og MRN</li>
        </ul>

        <p>
            Hovedprinsippet er at man i koblingsmeldingen angir de to MRN (inkl type MRN) som identifiserer de
            meldingene som skal kobles sammen.
        </p>

        <p>
            Hvis en kobling skal endres, gjøres dette ved å slette den innsendte koblingsmeldingen
            <strong>(DELETE i API)</strong> og opprette en ny koblingsmelding.
        </p>

        <p>
            API-dokumentasjon ligger som en del av Melde- og opplysnings API’ene for hver transportmåte, under Relation
            <a target="_blank" href="movement-road-api-v2.html">
                (Dokumentasjon for vei api, skroll lengere ned for koblings endepunkt)</a>.
            Det er ikke eksplisitte API’er for hver koblingstype.
        </p>


        <h2>API for å slå opp og få returnert MRN</h2>
        <p>
            Dersom innsender av relationship-melding ikke kjenner MRN, vil Digitoll ha spørre API som gjør det mulig å
            slå opp MRN på en melding dersom man besitter annen identifiserende informasjon om et objekt. For eksempel
            at man kjenner kjøretøynummer, grensepasseringssted, tidspunkt for grensepassering.
        </p>

        <p>
            Se <a target="_blank" href="https://toll.github.io/api/mo/movement-road-query-api-v2.html">
            <strong>API-dokumentasjon for spørre-API her</strong></a>.
        </p>

        <h2>Avgrensninger:</h2>

        <p>
            Det lages kun støtte for å koble sammen Digitoll-meldinger.
            Støtte for å koble deklarasjons-id (fra TVINN) til forsendelse (house) vil bli utviklet senere, men i første
            versjon er ikke dette med.
        </p>

        <p>
            Det lages ikke støtte for at man via relationship-melding kan sende inn referanse hverken til
            <strong>transittering, svensk eksport, postsekk (receptacle) eller ATA-carnet</strong>
            for å koble disse til transport/forsendelser.
        </p>

        <p>
            Koblingsmeldinger vil ikke løse utfordringen til næringslivet hvis aktørene som skal samhandle ikke kjenner
            hverandre/ikke utveksler nødvendig informasjon. Koblingsmeldinger åpner kun for at det blir mer fleksibelt
            hvem som tar ansvar for å samle og sende inn informasjon.
        </p>

        <h3>Case eksempel:</h3>
        <ul class="spaced-list">
            <li>Speditør sender inn hovedforsendelse <strong>før</strong> avtale om transport er avtalt. Digitoll
                utsteder MRN for meldingen.
            </li>
            <li>Transportør/fører sender inn transportmelding <strong>(ikke autentisert løsning eller ordinær
                Digitoll)</strong> uten referanse til hovedfraktbrev. Digitoll utsteder MRN for meldingen.
                <ul style="margin-top: 10px;">
                    <li>
                        Transportør/fører distribuerer MRN for transportmelding til de aktører transportør etterhvert
                        avtaler å transportere gods for.
                    </li>
                </ul>
            </li>
            <li>Speditør sender inn koblingsmelding
                <strong>(MRN til hovedforsendelse og MRN til transport)</strong>
                for å etablere nødvendig kobling når frakt er avtalt
            </li>
        </ul>

        <h3>Kode eksempel:</h3>
        <ul class="spaced-list">
            <li>Request:
                <pre class="boxed-display">
{
  "representative": "123456789",
  "parentObjectType": "TRANSPORT",
  "parentObjectReference": "24NO02091D3HAVFST5",
  "childObjectType": "MASTER_CONSIGNMENT",
  "childObjectReference": "24NO02091DW4BIEST4"
}
                </pre>
            </li>
            <li>Response: <strong><em>202, 400, 401, 403, 415, 500</em></strong> (som i dag)</li>
        </ul>
    </div>
</main>

<footer role="contentinfo">
    <a href="https://www.toll.no/">Tolletaten</a> 2025 |
    <a href="https://www.toll.no/no/om-tolletaten/kontakt-oss/" class="footerLink">Kontakt oss</a>
</footer>

</body>
</html>
